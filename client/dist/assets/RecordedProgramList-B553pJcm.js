import{d as ae,c as v,F as U,g as ue,k as S,h as u,b as e,e as V,t as p,r as G,n as F,o as d,_ as oe,a as i,w as x,A as I,U as j,P as J,N as _e,R as q,q as N,u as fe,C as z,l as M,f as he,p as W,j as ye,Q as Y,V as A,M as C,a3 as be,aa as we,E as ke,G as $e,T as Me,ae as Ve,af as Be,ag as Pe,ah as Le,ai as Ce,aj as le,ak as Ie,al as Z,am as D,O as Se,an as xe,ao as Re,I as He,ap as ze,aq as Ae,ar as Te,as as De,J as Fe,at as Ne,X as ee,au as de,a2 as ne,s as te,B as Ue}from"./index-CyocJmOS.js";import{V as me}from"./VDialog-CFkLbu3Z.js";import{a as ve,V as ce,b as We,c as Ee}from"./VCard-CMNZh63E.js";import{V as pe}from"./ssrBoot-D_4TVwjO.js";import{V as se}from"./Videos-cX_iY3mj.js";import{b as Oe,V as E,a as O,c as je,d as Ye}from"./VSelect-eH66UqRo.js";import{b as qe}from"./VTextField-CPaGDmrJ.js";const Ge={class:"breadcrumbs"},Ke={class:"breadcrumbs__item-text"},Xe=ae({__name:"Breadcrumbs",props:{crumbs:{}},setup(o){return(l,t)=>{const h=G("Icon"),m=G("router-link");return d(),v("div",Ge,[(d(!0),v(U,null,ue(l.crumbs,(c,R)=>(d(),S(m,{key:R,to:c.path,class:F(["breadcrumbs__item",{"breadcrumbs__item--disabled":c.disabled}]),event:c.disabled?"":"click"},{default:u(()=>[e("span",Ke,p(c.name),1),R<l.crumbs.length-1?(d(),S(h,{key:0,icon:"fluent:chevron-right-12-regular",width:"16px",class:"breadcrumbs__item-separator"})):V("",!0)]),_:2},1032,["to","class","event"]))),128))])}}}),ka=oe(Xe,[["__scopeId","data-v-1a3a34d9"]]),Je={class:"px-5 pb-6"},Qe={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-2"},Ze={class:"video-info__item"},et={class:"video-info__item-value"},tt={class:"video-info__item"},at={class:"video-info__item-value"},ot={class:"video-info__item"},it={class:"video-info__item-value"},st={class:"video-info__item"},rt={class:"video-info__item-value"},lt={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},dt={class:"video-info__item"},nt={class:"video-info__item-value"},ut={class:"video-info__item"},mt={class:"video-info__item-value"},vt={class:"video-info__item"},ct={class:"video-info__item-value"},pt={class:"video-info__item"},gt={class:"video-info__item-value"},_t={class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},ft={class:"video-info__item"},ht={class:"video-info__item-value"},yt={class:"video-info__item"},bt={class:"video-info__item-value"},wt={class:"video-info__item"},kt={class:"video-info__item-value"},$t={key:0,class:"text-subtitle-1 d-flex align-center font-weight-bold mt-3"},Mt={class:"video-info__item"},Vt={class:"video-info__item-value"},Bt={class:"video-info__item"},Pt={class:"video-info__item-value"},Lt={class:"video-info__item"},Ct={class:"video-info__item-value"},It=ae({__name:"RecordedFileInfoDialog",props:{program:{},show:{type:Boolean}},emits:["update:show"],setup(o){return(l,t)=>{const h=G("Icon");return d(),S(me,{"max-width":"770",transition:"slide-y-transition","model-value":l.show,"onUpdate:modelValue":t[1]||(t[1]=m=>l.$emit("update:show",m))},{default:u(()=>[i(ve,{class:"video-info"},{default:u(()=>[i(ce,{class:"px-5 pt-6 pb-3 d-flex align-center font-weight-bold",style:{height:"60px"}},{default:u(()=>[i(h,{icon:"fluent:document-20-filled",height:"26px"}),t[2]||(t[2]=e("span",{class:"ml-3"},"録画ファイル情報",-1)),i(pe),x((d(),v("div",{class:"d-flex align-center rounded-circle cursor-pointer px-2 py-2",onClick:t[0]||(t[0]=m=>l.$emit("update:show",!1))},[i(h,{icon:"fluent:dismiss-12-filled",width:"23px",height:"23px"})])),[[q]])]),_:1}),e("div",Je,[e("div",Qe,[i(h,{icon:"fluent:video-clip-20-filled",width:"24px",height:"20px"}),t[3]||(t[3]=e("span",{class:"ml-2"},"ファイル情報",-1))]),e("div",Ze,[t[4]||(t[4]=e("div",{class:"video-info__item-label"},"ファイルパス",-1)),e("div",et,p(l.program.recorded_video.file_path),1)]),e("div",tt,[t[5]||(t[5]=e("div",{class:"video-info__item-label"},"ファイルサイズ",-1)),e("div",at,p(I(j).formatBytes(l.program.recorded_video.file_size)),1)]),e("div",ot,[t[6]||(t[6]=e("div",{class:"video-info__item-label"},"録画期間",-1)),e("div",it,p(I(J).getRecordingTime(l.program)),1)]),e("div",st,[t[7]||(t[7]=e("div",{class:"video-info__item-label"},"最終更新日時",-1)),e("div",rt,p(I(_e)(l.program.recorded_video.file_modified_at).format("YYYY/MM/DD (dd) HH:mm:ss")),1)]),e("div",lt,[i(h,{icon:"fluent:video-20-filled",width:"24px",height:"20px"}),t[8]||(t[8]=e("span",{class:"ml-2"},"映像情報",-1))]),e("div",dt,[t[9]||(t[9]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",nt,p(l.program.recorded_video.video_codec)+" ("+p(l.program.recorded_video.video_codec_profile)+")",1)]),e("div",ut,[t[10]||(t[10]=e("div",{class:"video-info__item-label"},"解像度",-1)),e("div",mt,p(l.program.recorded_video.video_resolution_width)+"×"+p(l.program.recorded_video.video_resolution_height),1)]),e("div",vt,[t[11]||(t[11]=e("div",{class:"video-info__item-label"},"フレームレート",-1)),e("div",ct,p(l.program.recorded_video.video_frame_rate)+" fps",1)]),e("div",pt,[t[12]||(t[12]=e("div",{class:"video-info__item-label"},"スキャン方式",-1)),e("div",gt,p(l.program.recorded_video.video_scan_type),1)]),e("div",_t,[i(h,{icon:"fluent:speaker-2-20-filled",width:"24px",height:"20px"}),t[13]||(t[13]=e("span",{class:"ml-2"},"音声情報（主音声）",-1))]),e("div",ft,[t[14]||(t[14]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",ht,p(l.program.recorded_video.primary_audio_codec),1)]),e("div",yt,[t[15]||(t[15]=e("div",{class:"video-info__item-label"},"チャンネル",-1)),e("div",bt,p(l.program.recorded_video.primary_audio_channel),1)]),e("div",wt,[t[16]||(t[16]=e("div",{class:"video-info__item-label"},"サンプリングレート",-1)),e("div",kt,p(l.program.recorded_video.primary_audio_sampling_rate?`${l.program.recorded_video.primary_audio_sampling_rate/1e3}kHz`:"不明"),1)]),l.program.recorded_video.secondary_audio_codec?(d(),v("div",$t,[i(h,{icon:"fluent:speaker-2-20-filled",width:"24px",height:"20px"}),t[17]||(t[17]=e("span",{class:"ml-2"},"音声情報（副音声）",-1))])):V("",!0),l.program.recorded_video.secondary_audio_codec?(d(),v(U,{key:1},[e("div",Mt,[t[18]||(t[18]=e("div",{class:"video-info__item-label"},"コーデック",-1)),e("div",Vt,p(l.program.recorded_video.secondary_audio_codec),1)]),e("div",Bt,[t[19]||(t[19]=e("div",{class:"video-info__item-label"},"チャンネル",-1)),e("div",Pt,p(l.program.recorded_video.secondary_audio_channel),1)]),e("div",Lt,[t[20]||(t[20]=e("div",{class:"video-info__item-label"},"サンプリングレート",-1)),e("div",Ct,p(l.program.recorded_video.secondary_audio_sampling_rate?`${l.program.recorded_video.secondary_audio_sampling_rate/1e3}kHz`:"不明"),1)])],64)):V("",!0)])]),_:1})]),_:1},8,["model-value"])}}}),St=oe(It,[["__scopeId","data-v-66a6f916"]]),xt={class:"recorded-program__container"},Rt={class:"recorded-program__thumbnail"},Ht=["src"],zt={class:"recorded-program__thumbnail-duration"},At={key:0,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--recording"},Tt={key:1,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--analyzing"},Dt={key:2,class:"recorded-program__thumbnail-status recorded-program__thumbnail-status--partial"},Ft={key:3,class:"recorded-program__thumbnail-progress"},Nt={class:"recorded-program__content"},Ut=["innerHTML"],Wt={class:"recorded-program__content-meta"},Et={key:0,class:"recorded-program__content-meta-broadcaster"},Ot=["src"],jt={class:"recorded-program__content-meta-broadcaster-name"},Yt={key:1,class:"recorded-program__content-meta-broadcaster"},qt={class:"recorded-program__content-meta-time"},Gt=["innerHTML"],Kt={key:0,width:"22px",height:"22px",viewBox:"0 0 16 16"},Xt={key:0,width:"22px",height:"22px",viewBox:"0 0 16 16"},Jt={key:1,width:"22px",height:"22px",viewBox:"0 0 15.2 15.2"},Qt={class:"recorded-program__menu"},Zt={class:"delete-confirmation__file-path mb-4"},ea=ae({__name:"RecordedProgram",props:{program:{},forMylist:{type:Boolean,default:!1},forWatchedHistory:{type:Boolean,default:!1}},emits:["deleted"],setup(o,{emit:l}){const t=o,h=l,m=N(!1),c=N(!1),R=()=>{window.location.href=`${j.api_base_url}/videos/${t.program.id}/download`},s=async()=>{C.success("メタデータの再解析を開始します。完了までしばらくお待ちください。"),await se.reanalyzeVideo(t.program.id)===!0&&C.success("メタデータの再解析が完了しました。")},g=async(r=!1)=>{C.success("サムネイルの再作成を開始しました。完了までしばらくお待ちください。"),await se.regenerateThumbnail(t.program.id,r)===!0&&C.success("サムネイルの再作成が完了しました。")},w=fe(),y=()=>{w.settings.mylist.some(a=>a.type==="RecordedProgram"&&a.id===t.program.id)?(w.settings.mylist=w.settings.mylist.filter(a=>!(a.type==="RecordedProgram"&&a.id===t.program.id)),C.show("マイリストから削除しました。")):(w.settings.mylist.push({type:"RecordedProgram",id:t.program.id,created_at:j.time()}),C.success("マイリストに追加しました。"))},K=z(()=>w.settings.mylist.some(r=>r.type==="RecordedProgram"&&r.id===t.program.id)),k=z(()=>w.settings.watched_history.find(r=>r.video_id===t.program.id)),$=()=>{w.settings.watched_history=w.settings.watched_history.filter(r=>r.video_id!==t.program.id),C.show("視聴履歴から削除しました。")},P=()=>{const r=be();if(r.user===null||r.user.is_admin===!1){C.warning(`録画ファイルを削除するには管理者権限が必要です。
管理者アカウントでログインし直してください。`);return}c.value=!0},Q=async()=>{c.value=!1,C.info("録画ファイルの削除を開始します。完了までしばらくお待ちください。"),await se.deleteVideo(t.program.id)===!0&&(C.success("録画ファイルを削除しました。"),h("deleted",t.program.id))};return(r,a)=>{const H=G("Icon"),ie=G("router-link"),T=ye("ftooltip");return d(),v(U,null,[x((d(),S(ie,{class:F(["recorded-program",{"recorded-program--recording":r.program.recorded_video.status==="Recording","recorded-program--analyzing":!r.program.recorded_video.has_key_frames}]),to:r.program.recorded_video.status==="Recording"||!r.program.recorded_video.has_key_frames?{path:""}:`/videos/watch/${r.program.id}`},{default:u(()=>[e("div",xt,[e("div",Rt,[e("img",{class:"recorded-program__thumbnail-image",loading:"lazy",decoding:"async",src:`${I(j).api_base_url}/videos/${r.program.id}/thumbnail`},null,8,Ht),e("div",zt,p(I(J).getProgramDuration(r.program)),1),r.program.recorded_video.status==="Recording"?(d(),v("div",At,a[10]||(a[10]=[e("div",{class:"recorded-program__thumbnail-status-dot"},null,-1),M(" 録画中 ")]))):r.program.recorded_video.has_key_frames?r.program.is_partially_recorded?(d(),v("div",Dt," ⚠️ 一部のみ録画 ")):V("",!0):(d(),v("div",Tt,[i(H,{icon:"fluent:clock-12-regular",width:"15px",height:"15px"}),a[11]||(a[11]=M(" メタデータ解析中 "))])),k.value?(d(),v("div",Ft,[e("div",{class:"recorded-program__thumbnail-progress-bar",style:he(`width: ${k.value.last_playback_position/r.program.recorded_video.duration*100}%`)},null,4)])):V("",!0)]),e("div",Nt,[e("div",{class:"recorded-program__content-title",innerHTML:I(J).decorateProgramInfo(r.program,"title")},null,8,Ut),e("div",Wt,[r.program.channel?(d(),v("div",Et,[e("img",{class:"recorded-program__content-meta-broadcaster-icon",loading:"lazy",decoding:"async",src:`${I(j).api_base_url}/channels/${r.program.channel.id}/logo`},null,8,Ot),e("span",jt,"Ch: "+p(r.program.channel.channel_number)+" "+p(r.program.channel.name),1)])):(d(),v("div",Yt,a[12]||(a[12]=[e("span",{class:"recorded-program__content-meta-broadcaster-name"},"チャンネル情報なし",-1)]))),e("div",qt,p(I(J).getProgramTime(r.program)),1)]),e("div",{class:"recorded-program__content-description",innerHTML:I(J).decorateProgramInfo(r.program,"description")},null,8,Gt)]),r.forWatchedHistory?V("",!0):x((d(),v("div",{key:0,class:F(["recorded-program__mylist",{"recorded-program__mylist--highlight":K.value&&!r.forMylist}]),onClick:W(y,["prevent","stop"]),onMousedown:a[0]||(a[0]=W(()=>{},["prevent","stop"]))},[r.forMylist?(d(),v("svg",Kt,a[13]||(a[13]=[e("path",{fill:"currentColor",d:"M7 3h2a1 1 0 0 0-2 0M6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0zM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5"},null,-1)]))):(d(),v(U,{key:1},[K.value?(d(),v("svg",Xt,a[14]||(a[14]=[e("path",{fill:"currentColor",d:"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032"},null,-1)]))):(d(),v("svg",Jt,a[15]||(a[15]=[e("path",{fill:"currentColor",d:"M8 2.5a.5.5 0 0 0-1 0V7H2.5a.5.5 0 0 0 0 1H7v4.5a.5.5 0 0 0 1 0V8h4.5a.5.5 0 0 0 0-1H8z"},null,-1)])))],64))],34)),[[q],[T,K.value?"マイリストから削除する":"マイリストに追加する"]]),r.forWatchedHistory?x((d(),v("div",{key:1,class:"recorded-program__mylist",onClick:W($,["prevent","stop"]),onMousedown:a[1]||(a[1]=W(()=>{},["prevent","stop"]))},a[16]||(a[16]=[e("svg",{width:"22px",height:"22px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M7 3h2a1 1 0 0 0-2 0M6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.564l-1.205 8.838A2.5 2.5 0 0 1 9.754 15H6.246a2.5 2.5 0 0 1-2.477-2.162L2.564 4H2a.5.5 0 0 1 0-1zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0zM9.5 6a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 1 0v-5a.5.5 0 0 0-.5-.5"})],-1)]),32)),[[q],[T,"視聴履歴から削除する"]]):V("",!0),e("div",Qt,[i(je,{location:"bottom end","close-on-content-click":!0},{activator:u(({props:b})=>[x((d(),v("div",Y({class:"recorded-program__menu-button"},b,{onClick:a[2]||(a[2]=W(()=>{},["prevent","stop"])),onMousedown:a[3]||(a[3]=W(()=>{},["prevent","stop"]))}),a[17]||(a[17]=[e("svg",{width:"19px",height:"19px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M9.5 13a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0m0-5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0"})],-1)]),16)),[[q]])]),default:u(()=>[i(Oe,{density:"compact","bg-color":"background-lighten-1",class:"recorded-program__menu-list"},{default:u(()=>[i(E,{onClick:a[4]||(a[4]=b=>m.value=!0)},{prepend:u(()=>a[18]||(a[18]=[e("svg",{width:"20px",height:"20px",viewBox:"0 0 16 16"},[e("path",{fill:"currentColor",d:"M8.499 7.5a.5.5 0 1 0-1 0v3a.5.5 0 0 0 1 0zm.25-2a.749.749 0 1 1-1.499 0a.749.749 0 0 1 1.498 0M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1M2 8a6 6 0 1 1 12 0A6 6 0 0 1 2 8"})],-1)])),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>a[19]||(a[19]=[M("録画ファイル情報を表示")])),_:1})]),_:1}),i(E,{onClick:R,disabled:r.program.recorded_video.status==="Recording"},{prepend:u(()=>[i(H,{icon:"fluent:arrow-download-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>[M("録画ファイルをダウンロード ("+p(I(j).formatBytes(r.program.recorded_video.file_size))+")",1)]),_:1})]),_:1},8,["disabled"]),x((d(),S(E,{onClick:s},{prepend:u(()=>[i(H,{icon:"fluent:book-arrow-clockwise-20-regular",width:"20px",height:"20px"})]),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>a[20]||(a[20]=[M("メタデータを再解析")])),_:1})]),_:1})),[[T,"再生時に必要な録画ファイル情報や番組情報などを解析し直します"]]),x((d(),S(E,{onClick:a[5]||(a[5]=b=>g(!0))},{prepend:u(()=>[i(H,{icon:"fluent:image-arrow-counterclockwise-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>a[21]||(a[21]=[M("サムネイルを更新")])),_:1})]),_:1})),[[T,"既存のシークバー用サムネイルから代表サムネイルを選び直します 変更反映にはブラウザキャッシュの削除が必要です"]]),x((d(),S(E,{onClick:a[6]||(a[6]=b=>g(!1))},{prepend:u(()=>[i(H,{icon:"fluent:image-arrow-counterclockwise-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>a[22]||(a[22]=[M("サムネイルを再作成")])),_:1})]),_:1})),[[T,"サムネイルを完全に作り直します（数分かかります） 変更反映にはブラウザキャッシュの削除が必要です"]]),i(qe),i(E,{onClick:P,disabled:r.program.recorded_video.status==="Recording",class:"recorded-program__menu-list-item--danger"},{prepend:u(()=>[i(H,{icon:"fluent:delete-24-regular",width:"20px",height:"20px"})]),default:u(()=>[i(O,{class:"ml-3"},{default:u(()=>a[23]||(a[23]=[M("録画ファイルを削除")])),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})])])]),_:1},8,["to","class"])),[[q]]),i(St,{program:r.program,show:m.value,"onUpdate:show":a[7]||(a[7]=b=>m.value=b)},null,8,["program","show"]),i(me,{"max-width":"750",modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=b=>c.value=b)},{default:u(()=>[i(ve,null,{default:u(()=>[i(ce,{class:"d-flex justify-center pt-6 font-weight-bold"},{default:u(()=>a[24]||(a[24]=[M("本当に録画ファイルを削除しますか？")])),_:1}),i(We,{class:"pt-2 pb-0"},{default:u(()=>[e("div",Zt,p(r.program.recorded_video.file_path),1),a[25]||(a[25]=e("div",{class:"text-error-lighten-1 font-weight-bold"},[M(" この録画ファイルに関連するすべてのデータ (サムネイル / .ts.program.txt / .ts.err を含む) が削除されます。"),e("br"),M(" 元に戻すことはできません。本当に録画ファイルを削除しますか？ ")],-1))]),_:1}),i(Ee,{class:"pt-4 px-6 pb-6"},{default:u(()=>[i(pe),i(A,{color:"text",variant:"text",onClick:a[8]||(a[8]=b=>c.value=!1)},{default:u(()=>a[26]||(a[26]=[M("キャンセル")])),_:1}),i(A,{color:"error",variant:"flat",onClick:Q},{default:u(()=>a[27]||(a[27]=[M("削除")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ta=oe(ea,[["__scopeId","data-v-d2cb98d5"]]);function aa(){const o=N([]);we(()=>o.value=[]);function l(t,h){o.value[h]=t}return{refs:o,updateRef:l}}const oa=$e({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:o=>o.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:o=>o%1===0},totalVisible:[Number,String],firstIcon:{type:ee,default:"$first"},prevIcon:{type:ee,default:"$prev"},nextIcon:{type:ee,default:"$next"},lastIcon:{type:ee,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Ne(),...Fe(),...De(),...Te(),...Ae(),...ze(),...He({tag:"nav"}),...Re(),...xe({variant:"text"})},"VPagination"),ia=ke()({name:"VPagination",props:oa(),emits:{"update:modelValue":o=>!0,first:o=>!0,prev:o=>!0,next:o=>!0,last:o=>!0},setup(o,l){let{slots:t,emit:h}=l;const m=Me(o,"modelValue"),{t:c,n:R}=Ve(),{isRtl:s}=Be(),{themeClasses:g}=Pe(o),{width:w}=Le(),y=Ce(-1);le(void 0,{scoped:!0});const{resizeRef:K}=Ie(n=>{if(!n.length)return;const{target:_,contentRect:f}=n[0],B=_.querySelector(".v-pagination__list > *");if(!B)return;const L=f.width,X=B.offsetWidth+parseFloat(getComputedStyle(B).marginRight)*2;y.value=Q(L,X)}),k=z(()=>parseInt(o.length,10)),$=z(()=>parseInt(o.start,10)),P=z(()=>o.totalVisible!=null?parseInt(o.totalVisible,10):y.value>=0?y.value:Q(w.value,58));function Q(n,_){const f=o.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((n-_*f)/_).toFixed(2)))}const r=z(()=>{if(k.value<=0||isNaN(k.value)||k.value>Number.MAX_SAFE_INTEGER)return[];if(P.value<=0)return[];if(P.value===1)return[m.value];if(k.value<=P.value)return Z(k.value,$.value);const n=P.value%2===0,_=n?P.value/2:Math.floor(P.value/2),f=n?_:_+1,B=k.value-_;if(f-m.value>=0)return[...Z(Math.max(1,P.value-1),$.value),o.ellipsis,k.value];if(m.value-B>=(n?1:0)){const L=P.value-1,X=k.value-L+$.value;return[$.value,o.ellipsis,...Z(L,X)]}else{const L=Math.max(1,P.value-2),X=L===1?m.value:m.value-Math.ceil(L/2)+$.value;return[$.value,o.ellipsis,...Z(L,X),o.ellipsis,k.value]}});function a(n,_,f){n.preventDefault(),m.value=_,f&&h(f,_)}const{refs:H,updateRef:ie}=aa();le({VPaginationBtn:{color:D(o,"color"),border:D(o,"border"),density:D(o,"density"),size:D(o,"size"),variant:D(o,"variant"),rounded:D(o,"rounded"),elevation:D(o,"elevation")}});const T=z(()=>r.value.map((n,_)=>{const f=B=>ie(B,_);if(typeof n=="string")return{isActive:!1,key:`ellipsis-${_}`,page:n,props:{ref:f,ellipsis:!0,icon:!0,disabled:!0}};{const B=n===m.value;return{isActive:B,key:n,page:R(n),props:{ref:f,ellipsis:!1,icon:!0,disabled:!!o.disabled||+o.length<2,color:B?o.activeColor:o.color,"aria-current":B,"aria-label":c(B?o.currentPageAriaLabel:o.pageAriaLabel,n),onClick:L=>a(L,n)}}}})),b=z(()=>{const n=!!o.disabled||m.value<=$.value,_=!!o.disabled||m.value>=$.value+k.value-1;return{first:o.showFirstLastPage?{icon:s.value?o.lastIcon:o.firstIcon,onClick:f=>a(f,$.value,"first"),disabled:n,"aria-label":c(o.firstAriaLabel),"aria-disabled":n}:void 0,prev:{icon:s.value?o.nextIcon:o.prevIcon,onClick:f=>a(f,m.value-1,"prev"),disabled:n,"aria-label":c(o.previousAriaLabel),"aria-disabled":n},next:{icon:s.value?o.prevIcon:o.nextIcon,onClick:f=>a(f,m.value+1,"next"),disabled:_,"aria-label":c(o.nextAriaLabel),"aria-disabled":_},last:o.showFirstLastPage?{icon:s.value?o.firstIcon:o.lastIcon,onClick:f=>a(f,$.value+k.value-1,"last"),disabled:_,"aria-label":c(o.lastAriaLabel),"aria-disabled":_}:void 0}});function re(){var _;const n=m.value-$.value;(_=H.value[n])==null||_.$el.focus()}function ge(n){n.key===de.left&&!o.disabled&&m.value>+o.start?(m.value=m.value-1,ne(re)):n.key===de.right&&!o.disabled&&m.value<$.value+k.value-1&&(m.value=m.value+1,ne(re))}return Se(()=>i(o.tag,{ref:K,class:["v-pagination",g.value,o.class],style:o.style,role:"navigation","aria-label":c(o.ariaLabel),onKeydown:ge,"data-test":"v-pagination-root"},{default:()=>[i("ul",{class:"v-pagination__list"},[o.showFirstLastPage&&i("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[t.first?t.first(b.value.first):i(A,Y({_as:"VPaginationBtn"},b.value.first),null)]),i("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[t.prev?t.prev(b.value.prev):i(A,Y({_as:"VPaginationBtn"},b.value.prev),null)]),T.value.map((n,_)=>i("li",{key:n.key,class:["v-pagination__item",{"v-pagination__item--is-active":n.isActive}],"data-test":"v-pagination-item"},[t.item?t.item(n):i(A,Y({_as:"VPaginationBtn"},n.props),{default:()=>[n.page]})])),i("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[t.next?t.next(b.value.next):i(A,Y({_as:"VPaginationBtn"},b.value.next),null)]),o.showFirstLastPage&&i("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[t.last?t.last(b.value.last):i(A,Y({_as:"VPaginationBtn"},b.value.last),null)])])]})),{}}}),sa={key:0,class:"recorded-program-list__header"},ra={class:"recorded-program-list__title"},la={class:"recorded-program-list__title-text"},da={key:1,class:"recorded-program-list__title-count"},na={class:"recorded-program-list__empty-content"},ua=["innerHTML"],ma=["innerHTML"],va={class:"recorded-program-list__grid-content"},ca={key:1,class:"recorded-program-list__pagination"},pa=ae({__name:"RecordedProgramList",props:{title:{},programs:{},total:{},page:{default:1},sortOrder:{default:"desc"},hideHeader:{type:Boolean,default:!1},hideSort:{type:Boolean,default:!1},hidePagination:{type:Boolean,default:!1},showMoreButton:{type:Boolean,default:!1},showBackButton:{type:Boolean,default:!1},showEmptyMessage:{type:Boolean,default:!0},emptyIcon:{default:"fluent:warning-20-regular"},emptyMessage:{default:"録画番組が見つかりませんでした。"},emptySubMessage:{default:'サーバー設定で録画フォルダのパスを<br class="d-sm-none">正しく設定できているか確認してください。'},isLoading:{type:Boolean,default:!1},isSearching:{type:Boolean,default:!1},forMylist:{type:Boolean,default:!1},forWatchedHistory:{type:Boolean,default:!1}},emits:["update:page","update:sortOrder","more"],setup(o){Ue();const l=o,t=N(l.page),h=N(l.sortOrder),m=N([...l.programs]),c=N(l.total);te(()=>l.page,s=>{t.value=s}),te(()=>l.sortOrder,s=>{h.value=s}),te(()=>l.programs,s=>{m.value=[...s]}),te(()=>l.total,s=>{c.value=s});const R=s=>{m.value=m.value.filter(g=>g.id!==s),c.value--};return(s,g)=>{const w=G("Icon");return d(),v("div",{class:F(["recorded-program-list",{"recorded-program-list--show-sort":!s.hideSort}])},[s.hideHeader?V("",!0):(d(),v("div",sa,[e("h2",ra,[s.showBackButton?x((d(),v("div",{key:0,class:"recorded-program-list__title-back",onClick:g[0]||(g[0]=y=>s.$router.back())},[i(w,{icon:"fluent:chevron-left-12-filled",width:"27px"})])),[[q]]):V("",!0),e("span",la,p(s.title),1),s.showMoreButton?V("",!0):(d(),v("div",da,[s.isSearching?(d(),v(U,{key:0},[i(w,{icon:"line-md:loading-twotone-loop",class:"mr-1 spin",width:"20px",height:"20px"}),g[6]||(g[6]=e("span",null,"検索中...",-1))],64)):(d(),v(U,{key:1},[M(p(c.value)+"件",1)],64))]))]),e("div",{class:F(["recorded-program-list__actions",{"recorded-program-list__actions--mylist":s.forMylist}])},[s.hideSort?V("",!0):(d(),S(Ye,{key:0,modelValue:h.value,"onUpdate:modelValue":[g[1]||(g[1]=y=>h.value=y),g[2]||(g[2]=y=>s.$emit("update:sortOrder",y))],items:s.forMylist?[{title:"追加が新しい順",value:"mylist_added_desc"},{title:"追加が古い順",value:"mylist_added_asc"},{title:"録画が新しい順",value:"recorded_desc"},{title:"録画が古い順",value:"recorded_asc"}]:[{title:"新しい順",value:"desc"},{title:"古い順",value:"asc"}],"item-title":"title","item-value":"value",class:"recorded-program-list__sort",color:"primary","bg-color":"background-lighten-1",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue","items"])),s.showMoreButton?(d(),S(A,{key:1,variant:"text",class:"recorded-program-list__more",onClick:g[3]||(g[3]=y=>s.$emit("more"))},{default:u(()=>[g[7]||(g[7]=e("span",{class:"text-primary"},"もっと見る",-1)),i(w,{icon:"fluent:chevron-right-12-regular",width:"18px",class:"ml-1 text-text-darken-1",style:{margin:"0px -4px"}})]),_:1})):V("",!0)],2)])),e("div",{class:F(["recorded-program-list__grid",{"recorded-program-list__grid--loading":s.isLoading||s.isSearching,"recorded-program-list__grid--empty":c.value===0&&s.showEmptyMessage,"recorded-program-list__grid--searching":s.isSearching}])},[e("div",{class:F(["recorded-program-list__empty",{"recorded-program-list__empty--show":c.value===0&&s.showEmptyMessage&&!s.isSearching}])},[e("div",na,[i(w,{class:"recorded-program-list__empty-icon",icon:s.emptyIcon,width:"54px",height:"54px"},null,8,["icon"]),e("h2",{innerHTML:s.emptyMessage},null,8,ua),s.emptySubMessage?(d(),v("div",{key:0,class:"recorded-program-list__empty-submessage",innerHTML:s.emptySubMessage},null,8,ma)):V("",!0)])],2),e("div",va,[(d(!0),v(U,null,ue(m.value,y=>(d(),S(ta,{key:y.id,program:y,forMylist:s.forMylist,forWatchedHistory:s.forWatchedHistory,onDeleted:R},null,8,["program","forMylist","forWatchedHistory"]))),128))])],2),!s.hidePagination&&c.value>0?(d(),v("div",ca,[i(ia,{modelValue:t.value,"onUpdate:modelValue":[g[4]||(g[4]=y=>t.value=y),g[5]||(g[5]=y=>s.$emit("update:page",y))],"active-color":"primary",density:"comfortable",length:Math.ceil(c.value/30),"total-visible":7},null,8,["modelValue","length"])])):V("",!0)],2)}}}),$a=oe(pa,[["__scopeId","data-v-1730df4b"]]);export{ka as B,$a as R};
