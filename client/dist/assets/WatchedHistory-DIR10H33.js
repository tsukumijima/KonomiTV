import{d as y,u as v,y as r,B as m,D as f,an as w,ao as B,c as S,a as i,b as d,ap as b,o as q,_ as H}from"./index-CHrOVu2g.js";import{B as M}from"./VPagination-Ca2dDIk5.js";import{H as V,N as I}from"./Navigation-OoLMpi7u.js";import{R as N}from"./RecordedProgramList-DD3N7KJg.js";import{V as R}from"./Videos-y4shcRYt.js";import"./ssrBoot-xQqBeRGC.js";import"./VDialog-7M3TaIYt.js";import"./VChip-BsB8NpKA.js";import"./VTextField-CHj8rqTT.js";import"./VAvatar-DuwhBGds.js";import"./VCard-Cysj4ihK.js";import"./VSelect-CDucnF77.js";const k={class:"route-container"},x={class:"watched-history-container-wrapper"},E={class:"watched-history-container"},L=y({__name:"WatchedHistory",setup(P){const s=B(),g=b(),l=v(),n=r([]),c=r(0),t=r(!0),a=r(1),u=async()=>{const e=l.settings.watched_history.sort((p,_)=>_.updated_at-p.updated_at).map(p=>p.video_id);if(e.length===0){n.value=[],c.value=0,t.value=!1;return}const o=await R.fetchVideos("ids",a.value,e);o&&(n.value=o.recorded_programs,c.value=o.total),t.value=!1},h=async e=>{a.value=e,t.value=!0,await g.replace({query:{...s.query,page:e.toString()}})};return m(()=>s.query,async e=>{e.page&&(a.value=parseInt(e.page)),await u()},{deep:!0}),m(()=>l.settings.watched_history,async()=>{await u()},{deep:!0}),f(async()=>{await w().fetchUser(),s.query.page&&(a.value=parseInt(s.query.page)),await u()}),(e,o)=>(q(),S("div",k,[i(V),d("main",null,[i(I),d("div",x,[d("div",E,[i(M,{crumbs:[{name:"ホーム",path:"/"},{name:"視聴履歴",path:"/watched-history/",disabled:!0}]}),i(N,{title:"視聴履歴",programs:n.value,total:c.value,page:a.value,hideSort:!0,isLoading:t.value,showBackButton:!0,showEmptyMessage:!t.value,emptyIcon:"fluent:history-20-regular",emptyMessage:"まだ視聴履歴がありません。",emptySubMessage:"録画番組を30秒以上みると、<br class='d-sm-none'>視聴履歴に追加されます。",forWatchedHistory:!0,"onUpdate:page":h},null,8,["programs","total","page","isLoading","showEmptyMessage"])])])])]))}}),T=H(L,[["__scopeId","data-v-08a689a1"]]);export{T as default};
